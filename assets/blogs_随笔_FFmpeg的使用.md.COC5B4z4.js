import{_ as a,c as i,o as n,ak as p}from"./chunks/framework.CmzJUe0_.js";const l="/assets/ffmpeg20221020174351.OJplfPmH.png",t="/assets/ffmpeg20221020174539.B2RgYIJD.png",o=JSON.parse('{"title":"FFmpeg的使用","description":"","frontmatter":{"title":"FFmpeg的使用","date":"2022-07-01T00:00:00.000Z","sidebar":"auto","categories":["随笔"]},"headers":[],"relativePath":"blogs/随笔/FFmpeg的使用.md","filePath":"blogs/随笔/FFmpeg的使用.md"}'),e={name:"blogs/随笔/FFmpeg的使用.md"};function h(k,s,E,d,g,r){return n(),i("div",null,s[0]||(s[0]=[p('<p>[toc]</p><h2 id="ffmpeg的介绍" tabindex="-1">FFmpeg的介绍 <a class="header-anchor" href="#ffmpeg的介绍" aria-label="Permalink to &quot;FFmpeg的介绍&quot;">​</a></h2><p>FFmpeg是一套可以用来记录、转换数字音频、视频，并能将其转化为流的开源计算机程序。有非常强大的功能包括视频采集功能、视频格式转换、视频抓图、给视频加水印等。</p><h2 id="ffmpeg的安装" tabindex="-1">FFmpeg的安装 <a class="header-anchor" href="#ffmpeg的安装" aria-label="Permalink to &quot;FFmpeg的安装&quot;">​</a></h2><p>① 下载FFmpeg</p><p><a href="https://www.gyan.dev/ffmpeg/builds/ffmpeg-release-full.7z" target="_blank" rel="noreferrer">下载地址:https://www.gyan.dev/ffmpeg/builds/ffmpeg-release-full.7z</a></p><p>将下载的安装包解压，将其重命名为 ffmpeg，将 ffmpeg 文件夹放置到某个程序文件夹中，如：D:\\Program Files</p><p>② 配置电脑环境变量</p><p>此电脑 &gt; 右键-属性 &gt; 高级系统设置 &gt; 环境变量-&gt;双击 Path(选择用户变量和系统变量都可以，可以只操作一个，也可以都操作)</p><p><img src="'+l+'" alt="ffmpeg20221020174351.png"></p><p>新建path变量,变量值：D:\\Program Files\\ffmpeg\\bin</p><p>③ 测试是否安装成功</p><p>win+r，输入cmd，在DOS界面直接输入ffmpeg，如果显示这样的界面，说明配置成功。</p><p><img src="'+t+`" alt="ffmpeg20221020174539.png"></p><h2 id="ffmpeg的使用场景" tabindex="-1">FFmpeg的使用场景 <a class="header-anchor" href="#ffmpeg的使用场景" aria-label="Permalink to &quot;FFmpeg的使用场景&quot;">​</a></h2><p>例如：当你在b站上一个下载视频时。实际下载下来的是一个视频m4s文件和一个音频的m4s文件。此时可以使用FFmpeg将两个m4s文件混流为一个mp4文件。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>//在文件所在的根目录。使用命令把video.m4s 和audio.m4s 混流为mp4文件</span></span>
<span class="line"><span>ffmpeg -i D:/B站下载视频/s_32356/311449/80/video.m4s -i D:/B站下载视频/s_32356/311449/80/audio.m4s -c:v copy -strict experimental xxx4.mp4</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// blv文件，先改为flv文件，再把flv转换为mp4文件</span></span>
<span class="line"><span>ffmpeg -i D:/B站下载视频/s_1586/29134/lua.flv.bb2api.80/aaa.flv -c:v copy -strict experimental FateStayNight-UBW-07.mp4</span></span>
<span class="line"><span></span></span>
<span class="line"><span> //avi转换为mp4</span></span>
<span class="line"><span>ffmpeg -i F:/B站下载视频/1111/Gantz.TV.2004.DVDRip-Hi.x264.AC3.1280.EP17-nezumi.avi -c copy -map 0 aaa.mp4</span></span></code></pre></div><h2 id="ffmpeg-常用命令" tabindex="-1">FFmpeg 常用命令 <a class="header-anchor" href="#ffmpeg-常用命令" aria-label="Permalink to &quot;FFmpeg 常用命令&quot;">​</a></h2><p>转载自<a href="https://blog.csdn.net/wenmingzheng/article/details/88373192" target="_blank" rel="noreferrer">https://blog.csdn.net/wenmingzheng/article/details/88373192</a></p><h3 id="获取视频基本信息" tabindex="-1">获取视频基本信息 <a class="header-anchor" href="#获取视频基本信息" aria-label="Permalink to &quot;获取视频基本信息&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>//查看本地的视频信息</span></span>
<span class="line"><span>ffmpeg -i video.avi　</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>//查看远程视频信息</span></span>
<span class="line"><span>ffmpeg -i http://static.tripbe.com/videofiles/20121214/9533522808.f4v.mp4</span></span></code></pre></div><h3 id="分离视频音频流" tabindex="-1">分离视频音频流 <a class="header-anchor" href="#分离视频音频流" aria-label="Permalink to &quot;分离视频音频流&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>//分离视频流</span></span>
<span class="line"><span>ffmpeg -i input_file -vcodec copy -an output_file_video　　</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//分离音频流</span></span>
<span class="line"><span>ffmpeg -i input_file -acodec copy -vn output_file_audio　　</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>//去掉视频中的音频</span></span>
<span class="line"><span>ffmpeg -i input.mp4 -an output.mp4             </span></span>
<span class="line"><span></span></span>
<span class="line"><span>//去掉视频中的音频</span></span>
<span class="line"><span>ffmpeg -i test.avi -vcodec copy -an output.avi</span></span></code></pre></div><h3 id="视频转码相关" tabindex="-1">视频转码相关 <a class="header-anchor" href="#视频转码相关" aria-label="Permalink to &quot;视频转码相关&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>//ts视频流转mp4</span></span>
<span class="line"><span>ffmpeg -i test.ts -acodec copy -vcodec copy -f mp4 output.mp4</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//h264视频转ts视频流</span></span>
<span class="line"><span>ffmpeg -i test.h264 -vcodec copy -f mpegts output.ts</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//h264视频转mp4</span></span>
<span class="line"><span>ffmpeg -i test.h264 -vcodec copy -f mp4 output.mp4</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//mp4转flv</span></span>
<span class="line"><span>ffmpeg -i test.mp4 -b:v 640k output.flv </span></span>
<span class="line"><span></span></span>
<span class="line"><span>//mp4转flv</span></span>
<span class="line"><span>ffmpeg -i test.mp4 -acodec copy -vcodec copy -f flv output.flv </span></span>
<span class="line"><span></span></span>
<span class="line"><span>//flv转mp4</span></span>
<span class="line"><span>ffmpeg -i test.flv -b:v 640k output.mp4 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>//mp4转3gp</span></span>
<span class="line"><span>ffmpeg -i test.mp4 -s 176x144 -vcodec h263 -r 25 -b 12200 -ab 12200 -ac 1 -ar 8000 output.3gp </span></span>
<span class="line"><span></span></span>
<span class="line"><span>//avi转3gp</span></span>
<span class="line"><span>ffmpeg -i test.avi -s aqif -vcodec -acodec mp3 -ac 1 -ar 8000 -r 25 -ab 32 -y output.3gp </span></span>
<span class="line"><span></span></span>
<span class="line"><span>//3gp转flv</span></span>
<span class="line"><span>ffmpeg -i test.3gp -f avi -vcodec xvid -acodec mp3 -ar 22050 output.avi </span></span>
<span class="line"><span></span></span>
<span class="line"><span>//flv转3gp</span></span>
<span class="line"><span>ffmpeg -i test.flv -s 176x144 -vcodec h263 -r 25 -b 200 -ab 64 -acodec mp3 -ac 1 -ar 8000 output.3gp </span></span>
<span class="line"><span></span></span>
<span class="line"><span>//mp4转avi</span></span>
<span class="line"><span>ffmpeg -i test.mp4 output.avi </span></span>
<span class="line"><span></span></span>
<span class="line"><span>//flv转mp4</span></span>
<span class="line"><span>ffmpeg -i test.flv -vcodec h264 -r 25 -b 200 -ab 128 -acodec mp3 -ac 2 -ar 44100 output.mp4 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>//mp4转flv</span></span>
<span class="line"><span>ffmpeg -i test.mp4 -c:v libx264 -ar 22050 -crf 28 output.flv </span></span>
<span class="line"><span></span></span>
<span class="line"><span>//avi转mp4</span></span>
<span class="line"><span>ffmpeg -i test.avi -c copy -map 0 output.mp4 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>//m3u8转mp4</span></span>
<span class="line"><span>ffmpeg -i  http://vfile1.grtn.cn/2018/1542/0254/3368/154202543368.ssm/154202543368.m3u8 -c copy -bsf:a aac_adtstoasc -movflags +faststart test.mp4 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>//mkv转mp4</span></span>
<span class="line"><span>ffmpeg -i test.mkv -y -vcodec copy -acodec copy output.mp4 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>//mkv转avi</span></span>
<span class="line"><span>ffmpeg -i test.mkv -vcodec copy -acodec copy output.avi</span></span></code></pre></div><h3 id="图像处理相关" tabindex="-1">图像处理相关 <a class="header-anchor" href="#图像处理相关" aria-label="Permalink to &quot;图像处理相关&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>//截取指定时间的缩略图，-ss后跟的时间单位是秒</span></span>
<span class="line"><span>ffmpeg –i test.mp4 -y -f image2 -ss 8 -t 0.001 -s 350x240 testImage.jpg </span></span>
<span class="line"><span></span></span>
<span class="line"><span>//添加图片水印</span></span>
<span class="line"><span>ffmpeg -i input.mp4 -vf &quot;movie=logo.png [logo]; [in][logo] overlay=10:10:1 [out]&quot; output.mp4</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//添加图片水印</span></span>
<span class="line"><span>ffmpeg -i input.mp4 -i logo.png -filter_complex overlay test1.mp4</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//添加图片水印</span></span>
<span class="line"><span>ffmpeg –i input.mp4 -acodec copy-vcodec copy -vf &quot;movie=test.png[watermark];[in][watermark]overlay=10:10:1[out]&quot; output.mp4</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//添加GIF</span></span>
<span class="line"><span>ffmpeg -y -i test2.mp4 -ignore_loop 0 -i test.gif -filter_complex overlay=0:H-h test_out2.mp4</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//添加文字水印</span></span>
<span class="line"><span>ffmpeg -i input.flv -vf &quot;drawtext=fontfile=simhei.ttf: text=&#39;抖音&#39;:x=100:y=10:fontsize=24:fontcolor=yellow:shadowy=2&quot; drawtext.mp4</span></span></code></pre></div><h3 id="视频方向处理相关" tabindex="-1">视频方向处理相关 <a class="header-anchor" href="#视频方向处理相关" aria-label="Permalink to &quot;视频方向处理相关&quot;">​</a></h3><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//旋转90°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i test.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:v rotate</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;90&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">codec copy out.mp4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//顺时针旋转90°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i test.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vf </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;transpose=1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> out.mp4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//逆时针旋转90°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i test.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vf </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;transpose=2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> out.mp4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//顺时针旋转90°后再水平翻转</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i test.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vf </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;transpose=3&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> out.mp4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//逆时针旋转90°后再水平翻转</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i test.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vf </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;transpose=0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> out.mp4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//水平翻转视频画面</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i test.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vf hflip out.mp4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//垂直翻转视频画面</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i test.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vf vflip out.mp4</span></span></code></pre></div><h3 id="视频剪切相关" tabindex="-1">视频剪切相关 <a class="header-anchor" href="#视频剪切相关" aria-label="Permalink to &quot;视频剪切相关&quot;">​</a></h3><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//提取图片</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg –i test.avi –r </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> –f image2 image</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">3d.jpeg</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//-r 提取图像的频率，-ss 开始时间，-t 持续时间</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ss </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i input.avi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vcodec copy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acodec copy output.avi    </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//从10s处开始剪切，持续15秒</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ss </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i test.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">codec copy cut.mp4</span></span></code></pre></div><h3 id="倒放音视频-加速视频-减速视频" tabindex="-1">倒放音视频&amp;加速视频&amp;减速视频 <a class="header-anchor" href="#倒放音视频-加速视频-减速视频" aria-label="Permalink to &quot;倒放音视频&amp;加速视频&amp;减速视频&quot;">​</a></h3><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//视频倒放，无音频</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg.exe </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i inputfile.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">filter_complex [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:v]reverse[v] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">map [v] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">preset superfast reversed.mp4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//视频倒放，音频不变</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg.exe </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i inputfile.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vf reverse reversed.mp4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//音频倒放，视频不变</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg.exe </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i inputfile.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">map </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:v copy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">af </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;areverse&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> reversed_audio.mp4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//音视频同时倒放</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg.exe </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i inputfile.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vf reverse </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">af areverse </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">preset superfast reversed.mp4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//视频加速，帧速率变为2倍，调整倍速范围【0.25，4】</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i inputfile.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vf setpts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PTS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">af atempo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> output.mp4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//视频减速播放</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i input.mkv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">an </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:v </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;setpts=0.5*PTS&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> output.mkv</span></span></code></pre></div><h3 id="视频拼接" tabindex="-1">视频拼接 <a class="header-anchor" href="#视频拼接" aria-label="Permalink to &quot;视频拼接&quot;">​</a></h3><p>以mp4文件为例子，介绍两种方法，如果不是mp4文件，可以尝试先转码为mp4后再拼接起来。</p><p>方法1：将 mp4 先转码为 mpeg文件，mpeg是支持简单拼接的，然后再转回 mp4。</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i 1.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">qscale </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 1.mpg　</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">　</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i 2.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">qscale </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 2.mpg　</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cat 1.mpg 2.mpg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">f mpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">qscale </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vcodec mpeg4 output.mp4</span></span></code></pre></div><p>方法2：将 mp4 转化为同样编码形式的 ts 流，因为 ts流是可以拼接的，先把 mp4 封装成 ts ，然后 拼接 ts 流， 最后再把 ts 流转化为 mp4。</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i 1.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vcodec copy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acodec copy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vbsf h264_mp4toannexb 1.ts　　</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i 2.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vcodec copy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acodec copy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vbsf h264_mp4toannexb 2.ts</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;concat:1.ts|2.ts&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acodec copy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vcodec copy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">absf aac_adtstoasc output.mp4</span></span></code></pre></div><h3 id="视频合并" tabindex="-1">视频合并 <a class="header-anchor" href="#视频合并" aria-label="Permalink to &quot;视频合并&quot;">​</a></h3><p>下面通过动手实现抖音合拍功能来演示命令行的使用，首先准备好两个文件，都是用手机拍摄的。</p><ol><li>两个视频的合并（注意参数hstack代表是横向合并，也就是左右合并，横向合并的形象类比为“川”；如果是竖向合并，也就是上下合并，用参数vstack，竖向或者纵向合并的形象类比为“三”）</li></ol><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//注意：经过此命令处理后的视频output.mp4只会保留input1的音频</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i input1.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i input2.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lavfi hstack output.mp4</span></span></code></pre></div><ol start="2"><li>提取两个视频中的音频并合并音频</li></ol><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i input1.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acodec copy audio1.m4a</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i input2.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">vn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acodec copy audio2.m4a</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i audio1.m4a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i audio2.m4a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">filter_complex amerge </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ac </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:a libmp3lame </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">q</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:a </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> audio3.mp3</span></span></code></pre></div><ol start="3"><li>把audio3.mp3文件合并到output.mp4中去。</li></ol><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//success.mp4就是合拍视频，包含了两个视频的音频。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i output.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i audio3.mp3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:v copy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:a aac </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">strict experimental success.mp4</span></span></code></pre></div><p>如果想要三个视频合并（input=3表示希望合并的视频的个数）</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ffmpeg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i input1.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i input2.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i input3.mp4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lavfi hstack</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">inputs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> output.mp4</span></span></code></pre></div><h2 id="ffmpeg-常用参数说明" tabindex="-1">FFmpeg 常用参数说明 <a class="header-anchor" href="#ffmpeg-常用参数说明" aria-label="Permalink to &quot;FFmpeg 常用参数说明&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>命令格式：</span></span>
<span class="line"><span>    ffmpeg -i [输入文件名] [参数选项] -f [格式] [输出文件]</span></span>
<span class="line"><span>    ffmpeg [[options][\`-i&#39; input_file]]... {[options] output_file}...</span></span>
<span class="line"><span>    (1) h264: 表示输出的是h264的视频裸流</span></span>
<span class="line"><span>    (2) mp4: 表示输出的是mp4的视频</span></span>
<span class="line"><span>    (3)mpegts: 表示ts视频流</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>主要参数：</span></span>
<span class="line"><span>-i 设定输入流</span></span>
<span class="line"><span>-f 设定输出格式</span></span>
<span class="line"><span>-ss 开始时间</span></span>
<span class="line"><span></span></span>
<span class="line"><span>视频参数：</span></span>
<span class="line"><span>-b 设定视频流量，默认为200Kbit/s</span></span>
<span class="line"><span>-r 设定帧速率，默认为25</span></span>
<span class="line"><span>-s 设定画面的宽与高</span></span>
<span class="line"><span>-aspect 设定画面的比例</span></span>
<span class="line"><span>-vn 不处理视频</span></span>
<span class="line"><span>-vcodec 设定视频编解码器，未设定时则使用与输入流相同的编解码器，一般后面加copy表示拷贝</span></span>
<span class="line"><span></span></span>
<span class="line"><span>音频参数：</span></span>
<span class="line"><span>-ar 设定采样率</span></span>
<span class="line"><span>-ac 设定声音的Channel数</span></span>
<span class="line"><span>-acodec 设定声音编解码器，未设定时则使用与输入流相同的编解码器，一般后面加copy表示拷贝</span></span>
<span class="line"><span>-an 不处理音频</span></span></code></pre></div>`,51)]))}const y=a(e,[["render",h]]);export{o as __pageData,y as default};
